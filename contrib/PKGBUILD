pkgname=pacreport.d-git
_pkgname=pacreport.d
pkgver=1
pkgrel=1
pkgdesc='Known ghost files for Arch Linux'
arch=('any')
depends=('pacutils')
source=("$_pkgname::git+https://github.com/foxboron/pacreport.d.git")
sha256sums=('SKIP')

pkgver() {
    cd "$srcdir/$_pkgname"

    ( set -o pipefail
      git describe --long 2>/dev/null | sed 's/\([^-]*-g\)/r\1/;s/-/./g' ||
      printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
    )
}

package() {
    cd "$srcdir/$_pkgname"
    env PREFIX="$pkgdir/usr/local" make install install-hook
    mkdir --parents --mode=644 "$pkgdir"/etc/pacreport.d
}

